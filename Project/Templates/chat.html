<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yes/No/네고 채팅창</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
            /* 배경을 부드러운 그라데이션으로 설정 */
            background: linear-gradient(135deg, #a8e063, #56ab2f);
        }
        .chat-container {
            width: 500px;
            height: 700px;
            background-color: #d9f99d; /* 메시지 박스 배경 흰색 */
            border-radius: 20px; /* 둥근 테두리 */
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2); /* 부드러운 그림자 */
            display: flex;
            flex-direction: column;
            padding: 20px;
            overflow: hidden;
        }
        .chat-box {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px; /* 메시지 간격 */
            overflow-y: auto;
            padding: 20px;
            /* 초록색 그라데이션 배경 */
            background: linear-gradient(135deg, #a4d66d, #6fbb5d);
            border-radius: 10px;
            margin-bottom: 20px;
            border: 5px solid #3b7c27
        }
        .message {
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 75%; /* 메시지 박스의 최대 너비 */
            word-wrap: break-word; /* 긴 텍스트 줄바꿈 처리 */
            font-size: 16px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* 메시지 그림자 효과 */
        }
        .buyer-message {
            background-color: #4CAF50; /* 구매자 메시지 색상 */
            color: white;
            align-self: flex-end;
        }
        .seller-message {
            background-color: #2196F3; /* 판매자 메시지 색상 */
            color: white;
            align-self: flex-start;
        }
        .button-container {
            display: flex;
            gap: 10px;
            justify-content: center; /* 버튼 가운데 정렬 */
        }
        .button-container button {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s;
        }
        .button-container button:hover {
            transform: scale(1.1); /* 버튼에 호버 애니메이션 */
        }
        .yes-button {
            background-color: #4CAF50;
            color: white;
        }
        .no-button {
            background-color: #f44336;
            color: white;
        }
        .nego-button {
            background-color: #ffa500;
            color: white;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-box" id="chat-box">
            <!-- 채팅 메시지가 여기에 추가됩니다 -->
        </div>
        <div class="button-container" id="button-container">
            <!-- 버튼을 JavaScript에서 추가/삭제할 예정 -->
        </div>
    </div>

    <script>
        let isBuyerTurn = true; // 구매자 차례인지 판매자 차례인지 확인

        function sendResponse(response) {
            const chatBox = document.getElementById('chat-box');
            const responseMessage = document.createElement('div');
            
            // 구매자와 판매자의 메시지를 번갈아가며 표시
            if (isBuyerTurn) {
                responseMessage.textContent = "구매자: " + getBuyerResponse(response);
                responseMessage.classList.add('buyer-message', 'message');
            } else {
                responseMessage.textContent = "판매자: " + getSellerResponse(response);
                responseMessage.classList.add('seller-message', 'message');
            }

            chatBox.appendChild(responseMessage);
            chatBox.scrollTop = chatBox.scrollHeight; // 스크롤을 가장 아래로 이동

            isBuyerTurn = !isBuyerTurn; // 차례 변경
            updateButtons(); // 버튼 업데이트
        }

        function getBuyerResponse(response) {
            // 구매자 응답 처리
            if (response === 'Yes') {
                return "구매 가능할까요?";
            } else if (response === 'No') {
                alert("채팅을 종료합니다."); // No를 선택하면 채팅 종료
                location.href = "store_v2.html";
            } else if (response === '네고') {
                return "<가격>원으로 네고 가능할까요?";
            }
            return "";
        }

        function getSellerResponse(response) {
            // 판매자 응답 처리
            if (response === 'Yes') {
                setTimeout(() => {
                    alert("거래가 확정되었습니다."); // 거래 확정 알림
                    location.href = "store_v2.html";
                }, 2000);
                return "네! 가능합니다.";
            } else if (response === 'No') {
                setTimeout(() => {
                    alert("채팅이 종료됩니다."); // 판매불가 알림 후 종료
                    location.href = "store_v2.html";
                }, 2000);
                return "지금은 어려울 것 같습니다. 죄송합니다.";
            }
        }

        function updateButtons() {
            const buttonContainer = document.getElementById('button-container');
            buttonContainer.innerHTML = ''; // 기존 버튼 지우기

            if (isBuyerTurn) {
                const yesButton = document.createElement('button');
                yesButton.classList.add('yes-button');
                yesButton.textContent = 'Yes';
                yesButton.onclick = () => sendResponse('Yes');

                const noButton = document.createElement('button');
                noButton.classList.add('no-button');
                noButton.textContent = 'No';
                noButton.onclick = () => sendResponse('No');

                const negoButton = document.createElement('button');
                negoButton.classList.add('nego-button');
                negoButton.textContent = '네고';
                negoButton.onclick = () => sendResponse('네고');

                buttonContainer.appendChild(yesButton);
                buttonContainer.appendChild(noButton);
                buttonContainer.appendChild(negoButton);
            } else {
                const yesButton = document.createElement('button');
                yesButton.classList.add('yes-button');
                yesButton.textContent = 'Yes';
                yesButton.onclick = () => sendResponse('Yes');

                const noButton = document.createElement('button');
                noButton.classList.add('no-button');
                noButton.textContent = 'No';
                noButton.onclick = () => sendResponse('No');

                buttonContainer.appendChild(yesButton);
                buttonContainer.appendChild(noButton);
            }
        }

        updateButtons();
    </script>
</body>
</html>